"use strict";(globalThis.webpackChunkui_bridge_docs=globalThis.webpackChunkui_bridge_docs||[]).push([[6234],{2458(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"server/nextjs","title":"Next.js Integration","description":"Integrate UI Bridge with Next.js using App Router API routes.","source":"@site/docs/server/nextjs.md","sourceDirName":"server","slug":"/server/nextjs","permalink":"/ui-bridge/docs/server/nextjs","draft":false,"unlisted":false,"editUrl":"https://github.com/qontinui/ui-bridge/tree/main/docs-site/docs/server/nextjs.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Express Integration","permalink":"/ui-bridge/docs/server/express"},"next":{"title":"Standalone Server","permalink":"/ui-bridge/docs/server/standalone"}}');var i=t(4848),s=t(8453);const o={sidebar_position:3},a="Next.js Integration",l={},d=[{value:"Installation",id:"installation",level:2},{value:"API Routes Setup",id:"api-routes-setup",level:2},{value:"App Router (Next.js 13+)",id:"app-router-nextjs-13",level:3},{value:"Provider Setup",id:"provider-setup",level:3},{value:"Pages Router (Legacy)",id:"pages-router-legacy",level:2},{value:"Configuration",id:"configuration",level:2},{value:"With Authentication",id:"with-authentication",level:3},{value:"Development Only",id:"development-only",level:3},{value:"Using Components",id:"using-components",level:2},{value:"Server Components",id:"server-components",level:2},{value:"Edge Runtime",id:"edge-runtime",level:2},{value:"Middleware",id:"middleware",level:2},{value:"Complete Example",id:"complete-example",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"nextjs-integration",children:"Next.js Integration"})}),"\n",(0,i.jsx)(n.p,{children:"Integrate UI Bridge with Next.js using App Router API routes."}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install ui-bridge ui-bridge-server\n"})}),"\n",(0,i.jsx)(n.h2,{id:"api-routes-setup",children:"API Routes Setup"}),"\n",(0,i.jsx)(n.h3,{id:"app-router-nextjs-13",children:"App Router (Next.js 13+)"}),"\n",(0,i.jsx)(n.p,{children:"Create the catch-all route handler:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="app/api/ui-bridge/[...path]/route.ts"',children:"import { createNextHandler } from 'ui-bridge-server/nextjs';\n\nconst handler = createNextHandler({\n  features: {\n    control: true,\n    renderLog: true,\n    debug: process.env.NODE_ENV === 'development',\n  },\n});\n\nexport const GET = handler;\nexport const POST = handler;\nexport const DELETE = handler;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"provider-setup",children:"Provider Setup"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",metastring:'title="app/layout.tsx"',children:"import { UIBridgeProvider } from 'ui-bridge';\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <UIBridgeProvider\n          config={{\n            apiPath: '/api/ui-bridge',\n          }}\n        >\n          {children}\n        </UIBridgeProvider>\n      </body>\n    </html>\n  );\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"pages-router-legacy",children:"Pages Router (Legacy)"}),"\n",(0,i.jsx)(n.p,{children:"For Next.js 12 or Pages Router:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="pages/api/ui-bridge/[...path].ts"',children:"import { createPagesHandler } from 'ui-bridge-server/nextjs';\n\nexport default createPagesHandler({\n  features: {\n    control: true,\n    renderLog: true,\n  },\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"with-authentication",children:"With Authentication"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="app/api/ui-bridge/[...path]/route.ts"',children:"import { createNextHandler } from 'ui-bridge-server/nextjs';\nimport { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth';\n\nconst handler = createNextHandler({\n  features: {\n    control: true,\n    renderLog: true,\n  },\n});\n\nasync function withAuth(request: Request) {\n  const session = await getServerSession(authOptions);\n\n  if (!session) {\n    return new Response('Unauthorized', { status: 401 });\n  }\n\n  // Optional: Check for admin role\n  if (!session.user?.isAdmin) {\n    return new Response('Forbidden', { status: 403 });\n  }\n\n  return handler(request);\n}\n\nexport const GET = withAuth;\nexport const POST = withAuth;\nexport const DELETE = withAuth;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"development-only",children:"Development Only"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="app/api/ui-bridge/[...path]/route.ts"',children:"import { createNextHandler } from 'ui-bridge-server/nextjs';\n\nconst handler = createNextHandler();\n\n// Only enable in development\nconst devOnlyHandler = (request: Request) => {\n  if (process.env.NODE_ENV !== 'development') {\n    return new Response('Not Found', { status: 404 });\n  }\n  return handler(request);\n};\n\nexport const GET = devOnlyHandler;\nexport const POST = devOnlyHandler;\nexport const DELETE = devOnlyHandler;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"using-components",children:"Using Components"}),"\n",(0,i.jsx)(n.p,{children:"Register UI elements in your pages:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",metastring:'title="app/page.tsx"',children:"'use client';\n\nimport { useUIElement, useUIComponent } from 'ui-bridge';\nimport { useState } from 'react';\n\nexport default function HomePage() {\n  const [count, setCount] = useState(0);\n\n  const button = useUIElement({\n    id: 'counter-button',\n    type: 'button',\n  });\n\n  useUIComponent({\n    id: 'counter',\n    name: 'Counter Component',\n    actions: [\n      {\n        id: 'increment',\n        handler: async () => {\n          setCount(c => c + 1);\n          return { count: count + 1 };\n        },\n      },\n      {\n        id: 'reset',\n        handler: async () => {\n          setCount(0);\n          return { count: 0 };\n        },\n      },\n    ],\n  });\n\n  return (\n    <div>\n      <p>Count: {count}</p>\n      <button\n        ref={button.ref}\n        data-ui-id=\"counter-button\"\n        onClick={() => setCount(c => c + 1)}\n      >\n        Increment\n      </button>\n    </div>\n  );\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"server-components",children:"Server Components"}),"\n",(0,i.jsxs)(n.p,{children:["UI Bridge hooks require client components. Use the ",(0,i.jsx)(n.code,{children:"'use client'"})," directive:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// This won't work in a Server Component\n// 'use client' is required\n\n'use client';\n\nimport { useUIElement } from 'ui-bridge';\n\nexport function InteractiveButton() {\n  const control = useUIElement({ id: 'my-button', type: 'button' });\n  return <button ref={control.ref}>Click me</button>;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"edge-runtime",children:"Edge Runtime"}),"\n",(0,i.jsx)(n.p,{children:"UI Bridge is compatible with Edge Runtime:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="app/api/ui-bridge/[...path]/route.ts"',children:"import { createNextHandler } from 'ui-bridge-server/nextjs';\n\nexport const runtime = 'edge';\n\nconst handler = createNextHandler();\nexport const GET = handler;\nexport const POST = handler;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"middleware",children:"Middleware"}),"\n",(0,i.jsx)(n.p,{children:"Add UI Bridge to your middleware for request logging:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="middleware.ts"',children:"import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\n\nexport function middleware(request: NextRequest) {\n  if (request.nextUrl.pathname.startsWith('/api/ui-bridge')) {\n    // Log UI Bridge requests\n    console.log(`UI Bridge: ${request.method} ${request.nextUrl.pathname}`);\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: '/api/ui-bridge/:path*',\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,i.jsxs)(n.p,{children:["See the ",(0,i.jsx)(n.a,{href:"../examples/nextjs-app",children:"Next.js Example App"})," for a full working example."]})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>a});var r=t(6540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);
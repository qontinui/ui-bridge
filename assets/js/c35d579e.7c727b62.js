"use strict";(globalThis.webpackChunkui_bridge_docs=globalThis.webpackChunkui_bridge_docs||[]).push([[8184],{2755(e,t,n){n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"state/state-machine-integration","title":"State Machine Integration","description":"UI Bridge integrates with the multistate library to provide explicit state management for UI automation. This enables model-based testing and intelligent navigation.","source":"@site/docs/state/state-machine-integration.md","sourceDirName":"state","slug":"/state/state-machine-integration","permalink":"/ui-bridge/docs/state/state-machine-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/qontinui/ui-bridge/tree/main/docs-site/docs/state/state-machine-integration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Failure Recovery Strategies","permalink":"/ui-bridge/docs/recovery/failure-recovery-strategies"},"next":{"title":"Dynamic State Discovery","permalink":"/ui-bridge/docs/state/dynamic-state-discovery"}}');var i=n(4848),s=n(8453);const r={},l="State Machine Integration",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Basic Setup",id:"basic-setup",level:2},{value:"Define States",id:"define-states",level:3},{value:"Define Transitions",id:"define-transitions",level:3},{value:"State Detection",id:"state-detection",level:2},{value:"Get Current State",id:"get-current-state",level:3},{value:"Watch State Changes",id:"watch-state-changes",level:3},{value:"Validate State",id:"validate-state",level:3},{value:"State Navigation",id:"state-navigation",level:2},{value:"Navigate to State",id:"navigate-to-state",level:3},{value:"Get Path",id:"get-path",level:3},{value:"Execute Transition",id:"execute-transition",level:3},{value:"Integration with Registry",id:"integration-with-registry",level:2},{value:"Auto-Register States",id:"auto-register-states",level:3},{value:"Use in Components",id:"use-in-components",level:3},{value:"State Indicators",id:"state-indicators",level:2},{value:"Element-Based",id:"element-based",level:3},{value:"URL-Based",id:"url-based",level:3},{value:"Custom",id:"custom",level:3},{value:"Transition Guards",id:"transition-guards",level:2},{value:"State Persistence",id:"state-persistence",level:2},{value:"Visualization",id:"visualization",level:2},{value:"Best Practices",id:"best-practices",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"state-machine-integration",children:"State Machine Integration"})}),"\n",(0,i.jsxs)(t.p,{children:["UI Bridge integrates with the ",(0,i.jsx)(t.code,{children:"multistate"})," library to provide explicit state management for UI automation. This enables model-based testing and intelligent navigation."]}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(t.p,{children:"State machine integration provides:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Explicit modeling of UI states"}),"\n",(0,i.jsx)(t.li,{children:"Defined transitions between states"}),"\n",(0,i.jsx)(t.li,{children:"Automatic state detection"}),"\n",(0,i.jsx)(t.li,{children:"Path planning through state graphs"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,i.jsx)(t.h3,{id:"define-states",children:"Define States"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"import { StateMachine } from '@anthropic/ui-bridge';\n\nconst machine = new StateMachine({\n  states: {\n    'logged-out': {\n      description: 'User is not authenticated',\n      indicators: [\n        { type: 'element-exists', selector: '#login-form' },\n        { type: 'url-matches', pattern: /\\/(login|signin)/ },\n      ],\n    },\n    'logged-in': {\n      description: 'User is authenticated',\n      indicators: [\n        { type: 'element-exists', selector: '#user-menu' },\n        { type: 'element-not-exists', selector: '#login-form' },\n      ],\n    },\n    'dashboard': {\n      description: 'Main dashboard view',\n      indicators: [\n        { type: 'url-matches', pattern: /\\/dashboard/ },\n        { type: 'element-exists', selector: '.dashboard-grid' },\n      ],\n    },\n  },\n});\n"})}),"\n",(0,i.jsx)(t.h3,{id:"define-transitions",children:"Define Transitions"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"machine.addTransitions({\n  'logged-out -> logged-in': {\n    description: 'User logs in',\n    actions: [\n      { action: 'type', target: '#email', value: '{{email}}' },\n      { action: 'type', target: '#password', value: '{{password}}' },\n      { action: 'click', target: '#login-btn' },\n    ],\n    guards: [\n      { type: 'element-enabled', selector: '#login-btn' },\n    ],\n  },\n  'logged-in -> logged-out': {\n    description: 'User logs out',\n    actions: [\n      { action: 'click', target: '#user-menu' },\n      { action: 'click', target: '#logout-btn' },\n    ],\n  },\n  'logged-in -> dashboard': {\n    description: 'Navigate to dashboard',\n    actions: [\n      { action: 'click', target: '#dashboard-link' },\n    ],\n  },\n});\n"})}),"\n",(0,i.jsx)(t.h2,{id:"state-detection",children:"State Detection"}),"\n",(0,i.jsx)(t.h3,{id:"get-current-state",children:"Get Current State"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"const currentState = await machine.getCurrentState();\nconsole.log(currentState); // 'logged-out'\n"})}),"\n",(0,i.jsx)(t.h3,{id:"watch-state-changes",children:"Watch State Changes"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"machine.onStateChange((from, to) => {\n  console.log(`State changed: ${from} -> ${to}`);\n});\n"})}),"\n",(0,i.jsx)(t.h3,{id:"validate-state",children:"Validate State"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"const isValid = await machine.validateState('logged-in');\nconsole.log(isValid); // true if all indicators match\n"})}),"\n",(0,i.jsx)(t.h2,{id:"state-navigation",children:"State Navigation"}),"\n",(0,i.jsx)(t.h3,{id:"navigate-to-state",children:"Navigate to State"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"// Automatically finds and executes path to target state\nawait machine.navigateTo('dashboard', {\n  credentials: {\n    email: 'user@example.com',\n    password: 'secret',\n  },\n});\n"})}),"\n",(0,i.jsx)(t.h3,{id:"get-path",children:"Get Path"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"const path = machine.findPath('logged-out', 'dashboard');\nconsole.log(path);\n// ['logged-out -> logged-in', 'logged-in -> dashboard']\n"})}),"\n",(0,i.jsx)(t.h3,{id:"execute-transition",children:"Execute Transition"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"await machine.executeTransition('logged-out -> logged-in', {\n  email: 'user@example.com',\n  password: 'secret',\n});\n"})}),"\n",(0,i.jsx)(t.h2,{id:"integration-with-registry",children:"Integration with Registry"}),"\n",(0,i.jsx)(t.h3,{id:"auto-register-states",children:"Auto-Register States"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"import { UIBridgeProvider, useStateMachine } from '@anthropic/ui-bridge/react';\n\nfunction App() {\n  return (\n    <UIBridgeProvider\n      stateMachine={machine}\n      autoDetectState={true}\n    >\n      <Content />\n    </UIBridgeProvider>\n  );\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"use-in-components",children:"Use in Components"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"function Dashboard() {\n  const { currentState, navigateTo } = useStateMachine();\n\n  return (\n    <div>\n      <p>Current state: {currentState}</p>\n      <button onClick={() => navigateTo('settings')}>\n        Go to Settings\n      </button>\n    </div>\n  );\n}\n"})}),"\n",(0,i.jsx)(t.h2,{id:"state-indicators",children:"State Indicators"}),"\n",(0,i.jsx)(t.h3,{id:"element-based",children:"Element-Based"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"{\n  type: 'element-exists',\n  selector: '#user-menu',\n}\n\n{\n  type: 'element-not-exists',\n  selector: '#login-form',\n}\n\n{\n  type: 'element-visible',\n  selector: '.dashboard',\n}\n\n{\n  type: 'element-has-text',\n  selector: '#status',\n  text: 'Connected',\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"url-based",children:"URL-Based"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"{\n  type: 'url-matches',\n  pattern: /\\/dashboard/,\n}\n\n{\n  type: 'url-equals',\n  url: '/settings',\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"custom",children:"Custom"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"{\n  type: 'custom',\n  check: async () => {\n    const response = await fetch('/api/auth/status');\n    const data = await response.json();\n    return data.authenticated;\n  },\n}\n"})}),"\n",(0,i.jsx)(t.h2,{id:"transition-guards",children:"Transition Guards"}),"\n",(0,i.jsx)(t.p,{children:"Prevent transitions under certain conditions:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"machine.addTransition('logged-in -> admin', {\n  actions: [...],\n  guards: [\n    {\n      type: 'custom',\n      check: async () => {\n        const user = await getCurrentUser();\n        return user.role === 'admin';\n      },\n      message: 'User must be an admin',\n    },\n  ],\n});\n"})}),"\n",(0,i.jsx)(t.h2,{id:"state-persistence",children:"State Persistence"}),"\n",(0,i.jsx)(t.p,{children:"Save and restore state machine state:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"// Save\nconst snapshot = machine.serialize();\nlocalStorage.setItem('state-machine', JSON.stringify(snapshot));\n\n// Restore\nconst saved = JSON.parse(localStorage.getItem('state-machine'));\nmachine.restore(saved);\n"})}),"\n",(0,i.jsx)(t.h2,{id:"visualization",children:"Visualization"}),"\n",(0,i.jsx)(t.p,{children:"Generate state diagram:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"const diagram = machine.toMermaid();\nconsole.log(diagram);\n// stateDiagram-v2\n//   [*] --\x3e logged_out\n//   logged_out --\x3e logged_in: login\n//   logged_in --\x3e dashboard: navigate\n//   logged_in --\x3e logged_out: logout\n"})}),"\n",(0,i.jsx)(t.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Model Real States"})," - States should reflect actual UI states"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Clear Indicators"})," - Use reliable indicators for state detection"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Guard Transitions"})," - Prevent invalid transitions with guards"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Parameterize Actions"})," - Use variables for credentials and data"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Test Paths"})," - Verify all paths are navigable"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,t,n){n.d(t,{R:()=>r,x:()=>l});var a=n(6540);const i={},s=a.createContext(i);function r(e){const t=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);